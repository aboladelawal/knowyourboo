<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KYB Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@400;500;600;700&family=Caveat:wght@600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--flame:#FF5E3A;--gold:#FFD700;--magenta:#FF2D78;--deep:#0D0015;--card:#130820;--peach:#FFECD2}
body{font-family:'DM Sans',sans-serif;background:var(--deep);color:#fff;min-height:100vh;padding:20px}
.container{max-width:600px;margin:0 auto}

.header{text-align:center;padding:30px 0 20px}
.header h1{font-family:'Playfair Display',serif;font-size:1.8rem;color:var(--peach);margin-bottom:4px}
.header p{font-size:.82rem;color:rgba(255,255,255,.4)}

/* Login */
.login-box{
  max-width:360px;margin:40px auto;text-align:center;
  background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);
  border-radius:20px;padding:30px;
}
.login-box h2{font-family:'Playfair Display',serif;font-size:1.3rem;color:var(--peach);margin-bottom:12px}
.login-box input{
  width:100%;padding:12px 16px;margin-bottom:12px;
  background:rgba(255,255,255,.06);border:1.5px solid rgba(255,255,255,.08);
  border-radius:12px;color:#fff;font-family:'DM Sans',sans-serif;font-size:.9rem;outline:none;
}
.login-box input:focus{border-color:var(--flame)}
.login-box button{
  padding:12px 28px;border-radius:50px;border:none;
  background:linear-gradient(135deg,var(--flame),var(--magenta));
  color:#fff;font-weight:700;font-size:.9rem;cursor:pointer;
  font-family:'DM Sans',sans-serif;
}

/* Stats */
.stats{display:flex;gap:10px;justify-content:center;margin:20px 0;flex-wrap:wrap}
.stat{
  background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);
  border-radius:16px;padding:16px 24px;text-align:center;flex:1;min-width:100px;max-width:160px;
}
.stat .num{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:900;color:var(--gold)}
.stat .lbl{font-size:.7rem;color:rgba(255,255,255,.35);margin-top:2px}

/* Entries */
.entry{
  background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);
  border-radius:16px;padding:16px;margin-bottom:10px;
}
.entry .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.entry .names{font-weight:600;font-size:.9rem;color:var(--peach)}
.entry .score{
  background:linear-gradient(135deg,var(--flame),var(--magenta));
  padding:3px 12px;border-radius:50px;font-size:.78rem;font-weight:700;
}
.entry .arch{font-family:'Caveat',cursive;font-size:1.1rem;color:var(--gold);margin-bottom:4px}
.entry .verdict{font-size:.8rem;color:rgba(255,255,255,.5);line-height:1.4}
.entry .meta{font-size:.7rem;color:rgba(255,255,255,.2);margin-top:8px;display:flex;flex-wrap:wrap;gap:8px}
.entry .meta span{background:rgba(255,255,255,.04);padding:2px 8px;border-radius:6px}

.empty{text-align:center;padding:40px;color:rgba(255,255,255,.3);font-size:.9rem}
.back-link{
  display:inline-block;margin:16px 0;font-size:.85rem;color:var(--flame);
  text-decoration:none;opacity:.7;transition:opacity .3s;
}
.back-link:hover{opacity:1}

.hidden{display:none!important}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>üîÆ KYB Admin</h1>
    <p>Know Your Boo ‚Äî Submissions Dashboard</p>
  </div>

  <!-- LOGIN -->
  <div id="loginBox" class="login-box">
    <h2>üîí Admin Access</h2>
    <input type="password" id="pwdInput" placeholder="Enter admin password">
    <button onclick="login()">Enter</button>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <div class="stats">
      <div class="stat"><div class="num" id="totalStat">0</div><div class="lbl">Total</div></div>
      <div class="stat"><div class="num" id="avgStat">‚Äî</div><div class="lbl">Avg Score</div></div>
      <div class="stat"><div class="num" id="highStat">‚Äî</div><div class="lbl">Highest</div></div>
      <div class="stat"><div class="num" id="lowStat">‚Äî</div><div class="lbl">Lowest</div></div>
    </div>
    <a href="index.html" class="back-link">‚Üê Back to app</a>
    <div id="entries"></div>
  </div>
</div>

<script>
// ‚öôÔ∏è MUST MATCH YOUR index.html CONFIG
const CONFIG = {
  ADMIN_PASSWORD: 'abolade2025',
  SUPABASE_URL: '',
  SUPABASE_ANON_KEY: '',
};

function login() {
  if (document.getElementById('pwdInput').value === CONFIG.ADMIN_PASSWORD) {
    document.getElementById('loginBox').classList.add('hidden');
    document.getElementById('dashboard').classList.remove('hidden');
    loadData();
  } else {
    alert('Wrong password');
  }
}

// Enter key support
document.getElementById('pwdInput').addEventListener('keydown', e => { if(e.key==='Enter') login() });

async function loadData() {
  let subs = [];
  if (CONFIG.SUPABASE_URL && CONFIG.SUPABASE_ANON_KEY) {
    try {
      const r = await fetch(`${CONFIG.SUPABASE_URL}/rest/v1/submissions?order=timestamp.desc&limit=200`,
        {headers:{'apikey':CONFIG.SUPABASE_ANON_KEY,'Authorization':`Bearer ${CONFIG.SUPABASE_ANON_KEY}`}});
      subs = await r.json();
    } catch(e) { console.warn(e); }
  }
  if (!subs.length) subs = JSON.parse(localStorage.getItem('kyb_subs')||'[]');

  // Stats
  document.getElementById('totalStat').textContent = subs.length;
  if (subs.length) {
    const scores = subs.map(s => s.result?.compatibilityScore || 0).filter(s => s > 0);
    document.getElementById('avgStat').textContent = Math.round(scores.reduce((a,b)=>a+b,0)/scores.length) + '%';
    document.getElementById('highStat').textContent = Math.max(...scores) + '%';
    document.getElementById('lowStat').textContent = Math.min(...scores) + '%';
  }

  // Entries
  const el = document.getElementById('entries');
  if (!subs.length) { el.innerHTML = '<div class="empty">No submissions yet. Share the app link!</div>'; return; }

  el.innerHTML = subs.map(e => {
    const d = e.input || {}, r = e.result || {};
    const dt = e.timestamp ? new Date(e.timestamp).toLocaleString() : '';
    return `<div class="entry">
      <div class="top">
        <div class="names">${d.yourName||'?'} ‚Üî ${d.booName||'?'}</div>
        <div class="score">${r.compatibilityScore||'?'}%</div>
      </div>
      <div class="arch">${r.archetypeEmoji||''} ${r.archetype||''}</div>
      <div class="verdict">${r.verdict||''}</div>
      <div class="meta">
        <span>üìÖ ${dt}</span>
        <span>‚è≥ ${d.duration||'?'}</span>
        <span>üíò ${d.booLoveLang||d.loveLang||'?'}</span>
        <span>${d.yourGender||'?'} ‚Üí ${d.booGender||'?'}</span>
      </div>
    </div>`;
  }).join('');
}
</script>
</body>
</html>
